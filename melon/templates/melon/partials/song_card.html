<div class="song-card bg-white rounded-lg shadow-sm hover:shadow-md transition-shadow duration-300 p-4 fade-in"
     x-data="{ showLyrics: false }">
    <div class="flex items-start space-x-4">
        <!-- 순위 -->
        <div class="flex-shrink-0">
            <div class="w-12 h-12 flex items-center justify-center rounded-lg
                {% if song.rank <= 3 %}
                    bg-gradient-to-br from-yellow-400 to-orange-500 text-white font-bold text-lg
                {% elif song.rank <= 10 %}
                    bg-gradient-to-br from-gray-600 to-gray-700 text-white font-semibold
                {% else %}
                    bg-gray-100 text-gray-700 font-medium
                {% endif %}">
                {{ song.rank }}
            </div>
        </div>
        
        <!-- 앨범 커버 -->
        <div class="flex-shrink-0">
            <img src="{{ song.album.cover_image_url }}" 
                 alt="{{ song.album.name }}"
                 class="w-20 h-20 object-cover rounded-lg shadow-sm"
                 loading="lazy">
        </div>
        
        <!-- 곡 정보 -->
        <div class="flex-grow min-w-0">
            <div class="flex items-start justify-between">
                <div class="flex-grow min-w-0 mr-4">
                    <!-- 곡명 -->
                    <h3 class="text-lg font-semibold text-gray-900 truncate hover:text-melon-green transition-colors cursor-pointer"
                        @click="showLyrics = !showLyrics">
                        {{ song.title }}
                    </h3>
                    
                    <!-- 아티스트 -->
                    <p class="text-sm text-gray-600 mt-1">
                        {{ song.artist.name }}
                    </p>
                    
                    <!-- 앨범명 -->
                    <p class="text-xs text-gray-500 mt-1 truncate">
                        {{ song.album.name }}
                    </p>
                    
                    <!-- 메타 정보 -->
                    <div class="flex items-center space-x-4 mt-2">
                        <!-- 장르 -->
                        {% if song.genre %}
                        <span class="inline-flex items-center px-2 py-1 rounded-full text-xs font-medium bg-blue-100 text-blue-800">
                            {{ song.genre.0 }}
                        </span>
                        {% endif %}
                        
                        <!-- 발매일 -->
                        <span class="text-xs text-gray-500">
                            {{ song.release_date|date:"Y.m.d" }}
                        </span>
                    </div>
                </div>
                
                <!-- 좋아요 -->
                <div class="flex-shrink-0 text-right">
                    <div class="flex items-center space-x-1 text-red-500">
                        <svg class="w-5 h-5" fill="currentColor" viewBox="0 0 20 20">
                            <path fill-rule="evenodd" d="M3.172 5.172a4 4 0 015.656 0L10 6.343l1.172-1.171a4 4 0 115.656 5.656L10 17.657l-6.828-6.829a4 4 0 010-5.656z" clip-rule="evenodd"></path>
                        </svg>
                        <span class="text-sm font-medium">{{ song.likes|floatformat:0 }}</span>
                    </div>
                </div>
            </div>
            
            <!-- 가사 (토글) -->
            <div x-show="showLyrics" 
                 x-transition:enter="transition ease-out duration-300"
                 x-transition:enter-start="opacity-0 transform -translate-y-2"
                 x-transition:enter-end="opacity-1 transform translate-y-0"
                 x-transition:leave="transition ease-in duration-200"
                 x-transition:leave-start="opacity-1"
                 x-transition:leave-end="opacity-0"
                 class="mt-4 p-4 bg-gray-50 rounded-lg"
                 style="display: none;">
                <h4 class="text-sm font-semibold text-gray-700 mb-2">가사</h4>
                <pre class="text-xs text-gray-600 whitespace-pre-wrap font-sans max-h-40 overflow-y-auto">{{ song.lyrics|truncatechars:500 }}</pre>
                {% if song.lyrics|length > 500 %}
                <button class="text-xs text-melon-green hover:underline mt-2">더보기</button>
                {% endif %}
            </div>
        </div>
    </div>
</div>