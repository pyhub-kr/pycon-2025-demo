<div id="weather-widget" 
     class="bg-gradient-to-br from-blue-400 via-blue-500 to-blue-600 rounded-xl p-6 text-white shadow-lg relative"
     hx-get="{% url 'widgets:weather' %}?delay=1"
     hx-vals='js:{"_": Date.now()}'
     hx-trigger="load delay:10s"
     hx-swap="outerHTML"
     hx-indicator="#weather-indicator">
  
  <!-- í—¤ë”: ìœ„ì¹˜ì™€ ì—…ë°ì´íŠ¸ ì‹œê°„ -->
  <div class="flex justify-between items-center mb-4">
    <h3 class="text-lg font-semibold">ì„œìš¸</h3>
    <span class="text-sm opacity-80">{{ weather.updated_at|date:"H:i" }}</span>
  </div>
  
  <!-- í˜„ì¬ ë‚ ì”¨ ì •ë³´ -->
  <div class="grid grid-cols-2 gap-4 mb-6">
    <!-- ì˜¨ë„ì™€ ë‚ ì”¨ ìƒíƒœ -->
    <div>
      <div class="flex items-center">
        <div class="text-4xl font-bold">{{ weather.temp }}Â°C</div>
        {% if weather.icon == '01d' %}
          <span class="text-3xl ml-3">â˜€ï¸</span>
        {% elif weather.icon == '01n' %}
          <span class="text-3xl ml-3">ğŸŒ™</span>
        {% elif weather.icon == '02d' or weather.icon == '02n' %}
          <span class="text-3xl ml-3">â›…</span>
        {% elif weather.icon == '03d' or weather.icon == '03n' or weather.icon == '04d' or weather.icon == '04n' %}
          <span class="text-3xl ml-3">â˜ï¸</span>
        {% elif weather.icon == '09d' or weather.icon == '09n' or weather.icon == '10d' or weather.icon == '10n' %}
          <span class="text-3xl ml-3">ğŸŒ§ï¸</span>
        {% elif weather.icon == '11d' or weather.icon == '11n' %}
          <span class="text-3xl ml-3">â›ˆï¸</span>
        {% elif weather.icon == '13d' or weather.icon == '13n' %}
          <span class="text-3xl ml-3">â„ï¸</span>
        {% elif weather.icon == '50d' or weather.icon == '50n' %}
          <span class="text-3xl ml-3">ğŸŒ«ï¸</span>
        {% else %}
          <span class="text-3xl ml-3">ğŸŒ¡ï¸</span>
        {% endif %}
      </div>
      <div class="text-sm mt-2 opacity-90">{{ weather.description }}</div>
      <div class="text-xs mt-1 opacity-80">ì²´ê° ì˜¨ë„: {{ weather.feels_like }}Â°C</div>
    </div>
    
    <!-- ë‚ ì”¨ ìƒì„¸ ì •ë³´ -->
    <div class="space-y-2 text-sm">
      <div class="flex justify-between">
        <span class="opacity-80">ìŠµë„</span>
        <span class="font-semibold">{{ weather.humidity }}%</span>
      </div>
      <div class="flex justify-between">
        <span class="opacity-80">ë°”ëŒ</span>
        <span class="font-semibold">{{ weather.wind_speed }} m/s</span>
      </div>
      <div class="flex justify-between">
        <span class="opacity-80">ìµœê³ /ìµœì €</span>
        <span class="font-semibold">{{ weather.temp_max }}Â° / {{ weather.temp_min }}Â°</span>
      </div>
    </div>
  </div>
  
  <!-- ì¼ì¶œ/ì¼ëª° ì‹œê°„ -->
  <div class="flex justify-between text-sm border-t border-white/20 pt-4">
    <div class="flex items-center">
      <span class="mr-2">ì¼ì¶œ</span>
      <span class="font-semibold">{{ weather.sunrise|date:"H:i" }}</span>
    </div>
    <div class="flex items-center">
      <span class="mr-2">ì¼ëª°</span>
      <span class="font-semibold">{{ weather.sunset|date:"H:i" }}</span>
    </div>
  </div>
  
  <!-- ê°œì„ ëœ ë¡œë”© ì¸ë””ì¼€ì´í„° -->
  <div id="weather-indicator" class="htmx-indicator absolute inset-0 bg-blue-600/90 rounded-xl flex flex-col items-center justify-center backdrop-blur-sm">
    <div class="animate-spin rounded-full h-12 w-12 border-4 border-white border-t-transparent mb-3"></div>
    <span class="text-white text-sm font-medium">ë‚ ì”¨ ì •ë³´ ì—…ë°ì´íŠ¸ ì¤‘...</span>
  </div>
  
  {% if weather.is_default %}
  <!-- ê¸°ë³¸ ë°ì´í„° ì•ˆë‚´ -->
  <div class="mt-2 text-xs opacity-70 text-center">
    â„¹ï¸ ìƒ˜í”Œ ë°ì´í„°ì…ë‹ˆë‹¤
  </div>
  {% endif %}
</div>

<style>
  /* HTMX ì¸ë””ì¼€ì´í„° ê¸°ë³¸ ìŠ¤íƒ€ì¼ */
  .htmx-indicator {
    display: none;
  }
  
  /* ìš”ì²­ ì¤‘ì¼ ë•Œë§Œ í‘œì‹œ */
  .htmx-request .htmx-indicator,
  .htmx-request.htmx-indicator {
    display: flex !important;
  }
  
  /* ë¡œë”© ì¤‘ ì½˜í…ì¸  ì•½ê°„ íë¦¼ íš¨ê³¼ */
  #weather-widget.htmx-request > div:not(.htmx-indicator) {
    opacity: 0.3;
    transition: opacity 0.3s ease;
  }
</style>